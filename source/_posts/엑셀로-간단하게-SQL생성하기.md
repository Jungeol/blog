---
title: 엑셀로 간단하게 SQL생성하기
date: 2019-12-20 11:33:55
categories:
    - db
    - mssql
tags: 
    - sql
    - excel
---
# 엑셀로 간단하게 SQL 생성하기

개발을 하다보면 DB에서 데이터를 만질일이 생각보다 많은것 같다.

예를들어, 데이터량이 그렇게 많지않은 한 테이블에 특정 조건에따라 데이터를 업데이트 해줘야하는 상황이라고 가정해보자. 손으로 직접 하나하나 하자니 양이 많고, 직접 스크립트를 짜서 해기도 좀 그런 애매한 상황...

이럴때 엑셀 수식을 이용해서 SQL문을 생성하면 매우 간단하게 해결할 수 있다.

## 기본 사용법

엑셀 수식에서 기본적으로 알아야할 것은 딱 2가지다.

1. String은 `""` 안에 넣어서
2. String이나 Cell안의 내용을 합치는건 `&`

## 예제

```
= "UPDATE SOME_TABLE SET SOME_DATE='" & TEXT(B1, "yyyy-mm-dd") & "' WHERE " & "SOME_VALUE='" & A1 & "';"
```

위의 수식을 이용해 아래처럼 만들어 보았다.

(해당 예제는 MS Sql 기준)

{% asset_img excel_example01.PNG "MSSQL 예제" %}

## 유용한 엑셀 함수

1. TEXT 함수
    - 날짜형식의 경우 그냥 합칠경우 숫자로나와서 DB의 날짜형식과 맞지않아 잘못들어가는 경우가 생긴다. 이때 사용하면 된다.
    - ex> TEXT(A1, "yyyy-mm-dd")